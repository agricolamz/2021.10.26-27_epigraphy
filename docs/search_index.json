[["визуализация-с-ggplot2.html", "4 Визуализация с ggplot2 4.1 Построим первый график 4.2 Другие geom_...-ы 4.3 Сase studies", " 4 Визуализация с ggplot2 Для начала включим библиотеку library(&quot;tidyverse&quot;) и скачаем датасет: df &lt;- read_csv(&quot;https://tinyurl.com/yzfgony9&quot;) 4.1 Построим первый график Сначала сделаем данные для визуализации: df %&gt;% count(place) Теперь сделаем наш первый график: df %&gt;% count(place) %&gt;% ggplot()+ aes(x = place, y = n)+ geom_col() Мы можем поменять цвет получившегося: df %&gt;% count(place) %&gt;% ggplot()+ aes(x = place, y = n)+ geom_col(fill = &quot;darkgreen&quot;) Попробуем добавить гендерную пренадлежность усопших: df %&gt;% count(gender, place) %&gt;% ggplot()+ aes(x = place, y = n, fill = gender)+ geom_col() Так распределения сложно сравнивать, так что давайте сделаем их рядом: df %&gt;% count(gender, place) %&gt;% ggplot()+ aes(x = place, y = n, fill = gender)+ geom_col(position = &quot;dodge&quot;) Если мы не хотим сравнивать графики между собой, то их можно развести по разным подграфикам: df %&gt;% count(gender, place) %&gt;% ggplot()+ aes(x = gender, y = n)+ geom_col(position = &quot;dodge&quot;)+ facet_wrap(~place) По умолчанию рисуется одинаковая шкала, но можно это изменить при помощи аргумента scales = \"free\": df %&gt;% count(gender, place) %&gt;% ggplot()+ aes(x = gender, y = n)+ geom_col(position = &quot;dodge&quot;)+ facet_wrap(~place, scales = &quot;free&quot;) Ну что же настал момент, когда можно остановиться и осмыслить то, что мы видим: мужских надгробий больше чем женских (видите исключение?); в Стародубе больше надгробий, из которых нельзя извлечь информацию про пол усопшего, чем в Рашкове и Бешенковичах. Попробуйте воспроизвести график распределения типов надгробий. 4.2 Другие geom_...-ы В ggplot2 встроены очень много разных geom_...-ов (их инвентарь можно посмотреть, просто введя geom_ и нажав табуляцию). Например, мы можем украсить график, построенный ранее, просто добавив еще один geom_...: df %&gt;% count(gender, place) %&gt;% filter(gender == &quot;f&quot; | gender == &quot;m&quot; | gender == &quot;n&quot;) %&gt;% ggplot()+ aes(x = gender, y = n, label = n)+ geom_col()+ geom_label()+ facet_wrap(~place, scales = &quot;free&quot;) При этом необходимо помнить, что порядок действий имеет значение, если мы поменяем местами два geom_...-а, то получится не самый удачный график: df %&gt;% count(gender, place) %&gt;% filter(gender == &quot;f&quot; | gender == &quot;m&quot; | gender == &quot;n&quot;) %&gt;% ggplot()+ aes(x = gender, y = n, label = n)+ geom_label()+ geom_col()+ facet_wrap(~place, scales = &quot;free&quot;) 4.3 Сase studies 4.3.1 Гендерное распределение усопших df %&gt;% arrange(just_year_gre) %&gt;% group_by(gender) %&gt;% mutate(value = 1, sum = cumsum(value)) %&gt;% ggplot()+ aes(just_year_gre, sum, color = gender)+ geom_point()+ geom_line()+ labs(x = &quot;&quot;, y = &quot;количество захоронений&quot;) Какой вывод можно сделать на основании этого графика? df %&gt;% arrange(just_year_gre) %&gt;% group_by(place, gender) %&gt;% mutate(value = 1, sum = cumsum(value)) %&gt;% ggplot()+ aes(just_year_gre, sum, color = gender)+ geom_point()+ geom_line()+ facet_wrap(~place, scales = &quot;free&quot;)+ labs(x = &quot;&quot;, y = &quot;количество захоронений&quot;) Какой вывод можно сделать на основании этого графика? 4.3.2 Распределение некоторых имен во времени Возьмем наш датасет и выясним 3 самых популярных мужских и женских имен df %&gt;% filter(!is.na(name_ru), gender != &quot;n&quot;) %&gt;% select(name, gender) %&gt;% mutate(name = str_split(name, &quot; &quot;)) %&gt;% unnest_longer(name) %&gt;% count(name, gender, sort = TRUE) %&gt;% group_by(gender) %&gt;% top_n(3) -&gt; top_names top_names Попробуем посмотреть, как эти имена распределены во времени: df %&gt;% filter(!is.na(name_ru), !is.na(just_year_gre), gender != &quot;n&quot;) %&gt;% mutate(name = str_split(name, &quot; &quot;)) %&gt;% unnest_longer(name) %&gt;% filter(name %in% top_names$name) %&gt;% arrange(just_year_gre) %&gt;% mutate(value = 1) %&gt;% group_by(place, name) %&gt;% mutate(sum = cumsum(value)) %&gt;% ggplot()+ aes(just_year_gre, sum, color = name)+ geom_point()+ geom_line()+ facet_grid(gender~place, scales = &quot;free&quot;)+ labs(x = &quot;&quot;, y = &quot;количество захоронений&quot;) Какую разницу вы видите между разными населенными пунктами? "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
