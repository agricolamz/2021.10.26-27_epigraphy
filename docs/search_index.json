[["работа-с-картами-пакет-leaflet.html", "5 Работа с картами пакет leaflet 5.1 Визуализация с leaflet", " 5 Работа с картами пакет leaflet 5.1 Визуализация с leaflet Для начала включим библиотеку: library(&quot;tidyverse&quot;) library(&quot;leaflet&quot;) и скачаем датасет: df &lt;- read_csv(&quot;https://tinyurl.com/yzfgony9&quot;) Мы можем нарисовать точки, полученные из кладбища в Стародубе: df %&gt;% filter(place == &quot;Стародуб&quot;) %&gt;% leaflet() %&gt;% addTiles() %&gt;% addCircles(lng = ~longitude, lat = ~latitude, stroke = NA, radius = 1, fillOpacity = 1, label = ~tombstone_code) в Бешенковичах: df %&gt;% filter(place == &quot;Бешенковичи&quot;) %&gt;% leaflet() %&gt;% addTiles() %&gt;% addCircles(lng = ~longitude, lat = ~latitude, stroke = NA, radius = 1, fillOpacity = 1, label = ~tombstone_code) в Рашкове: df %&gt;% filter(place == &quot;Рашков&quot;) %&gt;% leaflet() %&gt;% addTiles() %&gt;% addCircles(lng = ~longitude, lat = ~latitude, stroke = NA, radius = 1, fillOpacity = 1, label = ~tombstone_code) Мы можем раскрасить наши точки на основании гендерной пренадлежности усопшего: pal_gender &lt;- colorFactor(&quot;Set1&quot;, domain = df$gender) df %&gt;% filter(place == &quot;Стародуб&quot;) %&gt;% leaflet() %&gt;% addTiles() %&gt;% addCircles(lng = ~longitude, lat = ~latitude, stroke = NA, radius = 2, fillOpacity = 1, label = ~tombstone_code, color = ~pal_gender(gender)) %&gt;% addLegend(pal = pal_gender, values = ~gender, title = &quot;&quot;) Зеленых точек n достаточно много, можно попробовать их убрать: df %&gt;% filter(place == &quot;Стародуб&quot;, gender != &quot;n&quot;) %&gt;% leaflet() %&gt;% addTiles() %&gt;% addCircles(lng = ~longitude, lat = ~latitude, stroke = NA, radius = 2, fillOpacity = 1, label = ~tombstone_code, color = ~pal_gender(gender)) %&gt;% addLegend(pal = pal_gender, values = ~gender, title = &quot;&quot;) Попробуем нарисовать кладбище в Бешенковичах и посмотрим, где расположены надгробия с тегами роженица: df %&gt;% mutate(labour = str_detect(tags, &quot;роды&quot;), labour = ifelse(is.na(labour), FALSE, labour)) -&gt; df pal_labour &lt;- colorFactor(&quot;Set1&quot;, domain = df$labour) df %&gt;% filter(place == &quot;Бешенковичи&quot;, !is.na(labour)) %&gt;% leaflet() %&gt;% addTiles() %&gt;% addCircles(lng = ~longitude, lat = ~latitude, stroke = NA, radius = 2, fillOpacity = 1, label = ~tombstone_code, color = ~pal_labour(labour)) %&gt;% addLegend(pal = pal_labour, values = ~labour, title = &quot;Распределение рожениц&quot;) Попробуем нарисовать кладбище в Бешенковичах и посмотрим, как оно заполнялось: df %&gt;% filter(place == &quot;Бешенковичи&quot;, !is.na(just_year_gre)) %&gt;% group_by(tombstone_code) %&gt;% mutate(id = 1:n()) %&gt;% filter(id == 1) %&gt;% ungroup() %&gt;% mutate(value = 1) %&gt;% arrange(-just_year_gre) %&gt;% pivot_wider(names_from = just_year_gre, values_from = value, values_fill = 0) %&gt;% pivot_longer(values_to = &quot;value&quot;, names_to = &quot;just_year_gre&quot;, `1772`:`1968`) %&gt;% group_by(tombstone_code, id) %&gt;% mutate(value = cumsum(value)) -&gt; bsh_sum library(leaflet.minicharts) leaflet() %&gt;% addTiles() %&gt;% addLegend(pal = pal_gender, values = bsh_sum$gender, title = &quot;&quot;) %&gt;% addMinicharts(lng = bsh_sum$longitude, lat = bsh_sum$latitude, chartdata = bsh_sum$value, time = as.double(bsh_sum$just_year_gre), fillColor = pal_gender(bsh_sum$gender), width = 7) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
